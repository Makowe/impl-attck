#include <stdio.h>
#include <inttypes.h>

#include "simon64_128_masked.h"

int main() {
    uint8_t key[16] = {
        0x1B, 0x1A, 0x19, 0x18, 0x13, 0x12, 0x11, 0x10, 
        0x0B, 0x0A, 0x09, 0x08, 0x03, 0x02, 0x01, 0x00
    };
    uint8_t entropy[48] = {
        0x1F, 0x2E, 0x3D, 0x4C, 0x5B, 0x6A, 0x79, 0x88,
        0x97, 0xA6, 0xB5, 0xC4, 0xD3, 0xE2, 0xF1, 0x00,
        0x10, 0x20, 0x30, 0x40, 0x50, 0x60, 0x70, 0x80,
        0x90, 0xA0, 0xB0, 0xC0, 0xD0, 0xE0, 0xF0, 0xFF,
        0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 0x11, 0x22,
        0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0x00
    };
    uint8_t pt[8] = {
        0x65, 0x6B, 0x69, 0x6C, 0x20, 0x64, 0x6E, 0x75
    };
    uint8_t ct[8];

    simon64_128_seed(entropy);
    simon64_128_set_key(key);
    simon64_128_encrypt(pt, ct);

    // Print ciphertext
    for (int i = 0; i < 8; i++) {
        printf("%02X ", ct[i]);
    }
    printf("\n");

    return 0;
}
